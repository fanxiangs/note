# Security Observability Requires Policy and Context

[[null|]][[null|]]The difference between a security tool and an observability tool that reports on events is that a security tool needs to be able to distinguish between events that are expected under normal circumstances and events that suggest malicious activity might be taking place. For example, suppose you have an application that writes data to a local file as part of its normal processing. Let’s say the app is expected to write to _/home//_, so this activity isn’t something you’re interested in from a security perspective. However, you would want to be notified if the app writes to one of the many sensitive file locations in Linux. For example, it is unlikely that it needs to modify the password information stored in _/etc/passwd_.

[[null|]]Policies have to take into account not just normal behavior when systems are fully functional, but also the expected error path behavior. For example, if a physical disk gets full, the application might start sending network messages to alert about this situation. These network messages shouldn’t be seen as security events—even though they are unusual, they’re not suspicious. Taking error paths into account can make it challenging to create effective policies, and we’ll come back to that challenge later in this chapter.

Defining what is and isn’t expected behavior is the job of a policy. A security tool compares activity to a policy and takes some action when the activity is outside the policy, making it suspicious. That action would typically involve generating a security event log, which would usually get sent to a Security Information Event Management (SIEM) platform. It might also result in an alert to a human who will be called on to investigate what happened.

The more contextual information that’s available to the investigator, the more likely they will be able to find out the root cause of the event and determine whether it was an attack, which components were affected, how and when the attack took place, and who was responsible. As illustrated in [[#contextual_information_is_required_alon|Figure 9-1]], being able to answer questions like this takes a tool from mere logging to deserving the nomenclature “security observability.”

![Contextual information is required alongside out-of-policy event detection for security observability](/Learning%20eBPF%20Programming%20the%20Linux%20Kernel%20for%20Enhanced%20Observability,%20Networking,%20and%20Security%20(Liz%20Rice)%20(Z-Library)/images/lebp_0901.png)

###### Figure 9-1. Contextual information is required alongside out-of-policy event detection for security observability

Let’s explore some of the ways eBPF programs are being used to detect and enforce security events. As you know, eBPF programs can be attached to a variety of events, and one set of events that have been commonly used for security for many years are syscalls. We’ll start our discussion with syscalls, but as you’ll see, syscalls might not be the most effective way to implement security tooling with eBPF. We’ll see some newer and more sophisticated approaches later in this chapter.[[null|]][[null|]]